<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Artifacts Panel Test</title>
    <link rel="stylesheet" href="../css/styles.css" />
    <style>
      body {
        padding: 16px;
        font:
          14px/1.4 system-ui,
          Segoe UI,
          Roboto,
          Arial,
          sans-serif;
      }
      .result {
        margin-top: 12px;
        padding: 8px 10px;
        border-radius: 8px;
      }
      .pass {
        background: #e6ffed;
        color: #046b1c;
        border: 1px solid #a6f4c5;
      }
      .fail {
        background: #ffeff0;
        color: #8a041a;
        border: 1px solid #ffd0d4;
      }
    </style>
  </head>
  <body>
    <h1>Artifacts Panel Test</h1>
    <p>Smoke test for render() contract and basic DOM output.</p>
    <div id="mount"></div>
    <div id="results" class="result">Runningâ€¦</div>
    <script type="module">
      import * as Artifacts from '../js/features/navigation/artifacts-panel.js';
      const mount = document.getElementById('mount');
      const errors = [];
      const resEl = document.getElementById('results');
      function assert(cond, msg) {
        if (!cond) errors.push(msg);
      }

      const modules = [
        { id: 'referral-1', type: 'referral', title: 'Referral from PCP' },
        { id: 'labs-1', type: 'labs', title: 'CBC Panel' },
      ];

      assert(typeof Artifacts.render === 'function', 'render export missing');
      const res = Artifacts.render(mount, {
        modules,
        isFacultyMode: true,
        onViewArtifact: () => {},
        onAddClicked: () => {},
      });
      assert(res && typeof res.cleanup === 'function', 'cleanup missing');
      assert(mount.querySelector('.artifact-category'), 'no category rendered');
      try {
        res.cleanup();
      } catch (e) {
        errors.push('cleanup threw');
      }

      resEl.textContent = errors.length ? 'FAIL: ' + errors.join('; ') : 'PASS';
      resEl.className = 'result ' + (errors.length ? 'fail' : 'pass');
      console.log('Artifacts Panel Test:', errors.length ? 'FAIL' : 'PASS', errors);
    </script>
  </body>
</html>
